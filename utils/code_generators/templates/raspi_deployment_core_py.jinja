{% for module_name_pascal_case, module_name_snake_case in ModuleNames %}
from fraikin_home_automation.modules.py_modules.{{module_name_snake_case}}.{{module_name_snake_case}} import {{module_name_pascal_case}}
{% endfor %}
from fraikin_home_automation.communication.external_interface_communication.raspi.interface_sender import InterfaceSender
from fraikin_home_automation.communication.external_interface_communication.raspi.interface_receiver import InterfaceReceiver

def init():
    interface_receiver.init()
    {% for module_name_pascal_case, module_name_snake_case in ModuleNames1 %}
    {{module_name_snake_case}}.init()
    {% endfor %}
    interface_sender.init()

def step():
    interface_receiver.step()
    {% for module_name_pascal_case, module_name_snake_case in ModuleNames2 %}
    {{module_name_snake_case}}.update_interface_subscription()
    {{module_name_snake_case}}.step()
    {{module_name_snake_case}}.update_interface_publishing()
    {% endfor %}
    interface_sender.step()


if __name__ == "__main__":
    # Interface Receiver
    interface_receiver = InterfaceReceiver()
    # All modules
    {% for module_name_pascal_case, module_name_snake_case in ModuleNames3 %}
    {{module_name_snake_case}} =  {{module_name_pascal_case}}();
    {% endfor %}
    # Interface sender
    interface_sender = InterfaceSender()

    init()
    while True:
        step()
